---
description: Vehicle 객체를 멤버 변수로서 사용하여 군집 드론 상황에서 다양한 명령을 수행하기 위한 클래스
---

# SwarmVehicle Class

## Public Interface

| **함수 이름**(입력 인자)                                                                                                |                                      **관련 변수**(타입)                                     | **실행시 구동되는 동작**                                                                                                                                                |
| --------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------: | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><strong>SwarmVehicle</strong></p><p>(ros::NodeHandle &#x26;, const std::string &#x26;, const int &#x26;)</p> |                                       대부분의 클래스 변수                                      | SwarmVehicle 객체를 생성하기 위한 가장 기본적인 생성자. 변수 초기화가 목적. 입력 파라미터에서 문자열은 군집의 이름을 뜻하고 기본값은 camila로 설정되어 있음. 마지막 int 변수는 군집 내의 드론의 총 대수를 의미하고 기본값은 1로 설정 되어 있음.          |
| <p><strong>SwarmVehicle</strong></p><p>(const SwarmVehicle &#x26;)</p>                                          |                                       대부분의 클래스 변수                                      | <p>복사 생성자. 다른 SwarmVehicle 객체로 부터 변수값을 카피해서 새로운 SwarmVehicle 객체를 생성함.</p><p><strong>복사 생성자를 구현하지 않을 경우 std::vector 같은 template library를 사용할 수 없다.</strong></p> |
| <p>const SwarmVehicle <strong>&#x26;operator=</strong></p><p>(const SwarmVehicle &#x26;)</p>                    |                                       대부분의 클래스 변수                                      | 대입 연산자 오버로딩. 복사 생성자와 마찬가지의 역할을 수행하며 구현하지 않을 경우의 제약 또한 같다.                                                                                                      |
| **\~SwarmVehicle**()                                                                                            |                                    ROS 관련 토픽, 서비스 변                                    | ROS와 관련된 publisher, subscriber, serviceClient 객체를 종료 시킨다.                                                                                                      |
| <p>void <strong>setSwarmInfo</strong></p><p>(const std::string &#x26;, const int &#x26;)</p>                    |        <p>swarm_name_</p><p>(std::string)</p><p>num_of_vehicle_</p><p>(int)</p>        | 입력 파라미터의 군집 정보에 따라 현재 SwarmVehicle 객체의 정보 및 NodeHandle의 정보를 업데이트 한다.                                                                                           |
| std::string **getSwarmInfo**() const                                                                            |        <p>swarm_name_</p><p>(std::string)</p><p>num_of_vehicle_</p><p>(int)</p>        | 군집 정보 중 군집이름을 리턴한다.                                                                                                                                            |
| <p>void <strong>addVehicle</strong></p><p>(const VehicleInfo &#x26;)</p>                                        |   <p>camila_</p><p>(std::vector&#x3C;Vehicle>)</p><p>num_of_vehicle_</p><p>(int)</p>   | VehicleInfo를 받아서 군집에 드론을 추가하는 인터페이스                                                                                                                            |
| <p>void <strong>deleteVehicle</strong></p><p>(const VehicleInfo &#x26;)</p>                                     |   <p>camila_</p><p>(std::vector&#x3C;Vehicle>)</p><p>num_of_vehicle_</p><p>(int)</p>   | VehicleInfo를 받아서 군집내에서 일치하는 vehicle을 제거하는 인터페이                                                                                                                 |
| void **showVehicleList**() const                                                                                |                    <p>camila_</p><p>(std::vector&#x3C;Vehicle>)</p>                    | 현재 군집 내에 있는 모든 Vehicle의 이름과 id를 출력해주는 인터페이                                                                                                                     |
| void **run**()                                                                                                  | <p>camila_</p><p>(std::vector&#x3C;Vehicle>)</p><p>kp_sp_, kp_seek_</p><p>(double)</p> | 군집의 모든 기능이 제대로 구현되기 위해 필수적으로 주 노드에서 실행되어야 하는 인터페이스                                                                                                             |

## Private Interface

| 함수 이름                                                                                                                                                                       |                       관련 변수(타입)                       | 실행시 구동되는 동작                                                                 |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------: | --------------------------------------------------------------------------- |
| void **swarmServiceInit**()                                                                                                                                                 |                ROS와 관련된  토픽, 서비스 관련 변수                | 군집의 기본적인 정보를 받아오기 위해 토픽과 서비스 정보 초기화.                                        |
| void **release**()                                                                                                                                                          |                ROS와 관련된  토픽, 서비스 관련 변수                | ROS와 관련된 publisher,   subscriber, serviceClient 객체를 종료.                     |
| void **updateOffset**()                                                                                                                                                     | <p>offset_</p><p>(std::vector&#x3C;tf2::Vector3>)</p> | 각 드론의 GPS 좌표를 통해 1번드론의 홈좌표와의 오프셋을 ENU로 변환하여  offset\_벡터에 기록하는 인터페이스         |
| void **limit**(tf2::Vector3 &, const double &)                                                                                                                              |                           -                           | 전달된 tf2::Vector3 변수의 크기를 Limit 값으로 제하나는 인터페이스                               |
| void **getVehiclePos**()                                                                                                                                                    |                      각 드론의 pos\_                      | 통합 좌표계 내에서의 각각의 드론의 좌표를 계산하여 저장하는 인터페이스                                     |
| <p>void <strong>separate</strong></p><p>(Vehicle &#x26;)</p>                                                                                                                |                 각 드론의 sum\_sp\_, pos\_                | 통합 좌표계 내에서 각각의 드론의 좌표를 통해 드론이 피해가야가는 벡터를 계산하는 인터페이스                         |
| void **seek**(Vehicle &)                                                                                                                                                    |              각 드론의 target\_, pos\_, err\_             | 각 드론의 타겟 좌표와 현재 좌표와의 차이를 통해 err\_ 벡터를 계산                                    |
| void **formationGenerator**()                                                                                                                                               |                     각 드론의 target\_                    | 포메이션의 형태에 따라 각 드론의 local\_target을 계산하여 기록하는 인터페이스                           |
| <p>bool <strong>multiSetpointLocal</strong></p><p>(drone_base::srvMultiSetpointLocal<br>::Request &#x26;req, drone_base::srvMultiSetpointLocal<br>::Response &#x26;res)</p> |                           -                           | 서비스를 통해 들어온 formation\_과 x, y, z 값을 통해 군집의 타겟을 지정                           |
| <p>bool <strong>multiSetpointGlobal</strong><br>(drone_base::srvMultiSetpointGlobal<br>::Request &#x26;req, drone_base::srvMultiSetpointGlobal<br>::Response &#x26;res)</p> |                           -                           | <p>서비스를 통해 들어온 좌표를 통해 군집의 글로벌 좌표를 지정</p><p><strong>그러나 현재 미구현</strong> </p> |
| <p>bool <strong>gotoVehicle</strong></p><p>(drone_base::srvGoToVehicle<br>::Request &#x26;req, drone_base::srvGoToVehicle<br>::Response &#x26;res)</p>                      |                           -                           | 군집 내에서 특정한 하나의 드론을 이동시키기 위한 인터페이스                                           |
| <p>static tf2::Vector3 <strong>convertGeoToENU</strong></p><p>(const sensor_msgs::NavSatFix &#x26;, const sensor_msgs::NavSatFix &#x26;)</p>                                |                           -                           | GPS 좌표간의 차이를 통해 ENU 좌표계의offset\_ 값을 계산하여 리턴하는 인터페이스                         |
| <p>static geographic_msgs::GeoPoint <strong>convertENUToGeo</strong></p><p>(const geometry_msgs::PoseStamped &#x26;, const sensor_msgs::NavSatFix &#x26;)</p>               |                           -                           | ENU 좌표계를 통해 GPS 좌표의 offset으로 계산하여 리턴하는 인터페이스                                |
| bool **isPublish**()                                                                                                                                                        |                           -                           | 각각의 드론의 setpoint\_publish\_flag를 확인하여 공통의 셋포인트가 기록 되었는지 확인하는 인터페이스          |
| <p>void <strong>triggerCB</strong></p><p>(const std_msgs<del>:</del>:Empty::ConstPtr &#x26;)</p>                                                                            |                           -                           | 트리거 토픽을 통해 입력이 들어올 경우 arming 신호를 보내고 offboard 모드로 변경하는 인터페이스                |

